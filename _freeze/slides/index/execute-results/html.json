{
  "hash": "07126177c53f0deb1d808a188e590ec4",
  "result": {
    "markdown": "---\ntitle: \"Data Cleaning\"\nauthor: \"Crystal Lewis, Shannon Pileggi, & Peter Higgins\"\nfooter: \"[Data Cleaning](https://shannonpileggi.github.io/rmedicine-data-cleaning-2023)\"\nlogo: \"images/R-Med-logo-revised-pride.png\"\neditor: source\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\n    chalkboard: true\nexecute:\n  echo: true\n  freeze: auto\ncache: true\n---\n# Introduction\n\n::: {.cell}\n\n:::\n\n## Licensing\n\n<br>\n\nThis work is licensed under [Creative Commons Zero v1.0 Universal](https://creativecommons.org/publicdomain/zero/1.0/).\n\n\n## Instructors\n\n::: columns\n::: {.column width=\"33%\"}\n**Crystal Lewis**\n\n![](images/Crystal_circle.png){width=\"70%\"}\n\n:::\n::: {.column width=\"33%\"}\n**Shannon Pileggi**\n\n![](images/Shannon_circle.png){width=\"70%\"}\n:::\n\n::: {.column width=\"33%\"}\n**Peter Higgins**\n\n![](images/Peter_circle.jpg){width=\"70%\"}\n\n\n\n:::\n:::\n\n\n## Checklist\n\n<br>\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#606060;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} Install recent R release\n\n    Current version 4.3.0\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#606060;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} Install RStudio\n\n    I am on version 2022.07.1+554 \n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#606060;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} Install packages\n\n``` r\n# install.packages(c(\"gtreg\", \"gtsummary\", \"tidyverse\", \"labelled\", \"usethis\"))\n```\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#606060;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} Ensure you can knit Rmarkdown files\n\n## Schedule\n\n| Time          | Activity           |\n|:--------------|:-------------------|\n| 09:00 - 09:50 | Section 1          |\n| 09:50 - 10:00 | *Break*            |\n| 10:00 - 10:50 | Section 2          |\n| 10:50 - 11:00 | *Break*            |\n| 11:00 - 12:00 | Section 3          |\n\n<br>\n\nPlease add any questions to the public Zoom chat. These may be answered in the \nmoment or addressed at the end depending on context.\n\n\n# Crystal Section A\n\n## Slide 1\n\n## Slide 2\n\n# Crystal Section B\n\n## Slide 1\n\n## Slide 2\n\n# Stage 1 cleaning\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-2_1a098d13f56fbeee6a04450395cc3aac'}\n\n:::\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-3_f2ce1cecded57c226a27faa973d1d7b3'}\n\n:::\n\n\n## Variable names\n\nOriginal variable names in excel: \n\n![](images/var_names_1.PNG)\n\n. . .\n\n<br>\n\nVariable names import as shown, with modifications from `readxl::read_excel()` to ensure uniqueness:\n\n![](images/var_names_2.PNG)\n\n\n\n## Variable names, cleaner\n\nVariable names as imported:\n\n![](images/var_names_2.PNG)\n\n. . .\n\n<br>\n\n`janitor::clean_names()` removes special characters and implements snake case by default:\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-4_9ff3e3fa7f3315883fb0dc97895ab7ee'}\n\n```{.r .cell-code}\ndf_raw |> janitor::clean_names() \n```\n:::\n\n![](images/var_names_3.PNG)\n\n## Remove empty columns or rows\n\n\n::: panel-tabset\n\n### Problem\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-5_7efac51a2cc9ae7ba4b376ba01ce5f3d'}\n\n```{.r .cell-code}\ndf_raw |> \n  janitor::clean_names() |> \n  select(pat_id, race:start_bp) |> \n  slice(13:18)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  pat_id race             dob                 x7    start_bp\n  <chr>  <chr>            <dttm>              <lgl> <chr>   \n1 013    Caucasian        1948-02-27 00:00:00 NA    118/73  \n2 014    African-American 1966-04-22 00:00:00 NA    106/59  \n3 015    H/API            1978-08-11 00:00:00 NA    112/69  \n4 <NA>   <NA>             NA                  NA    <NA>    \n5 016    African-American 1998-10-28 00:00:00 NA    114/76  \n6 017    Caucasian        2001-01-09 00:00:00 NA    124/80  \n```\n:::\n:::\n\n### Solution\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-6_e6db3b3cc2c2bdf87502b1141e7bedfa'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\ndf_raw |> \n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  select(pat_id, race:start_bp) |> \n  slice(13:18)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  pat_id race             dob                 start_bp\n  <chr>  <chr>            <dttm>              <chr>   \n1 013    Caucasian        1948-02-27 00:00:00 118/73  \n2 014    African-American 1966-04-22 00:00:00 106/59  \n3 015    H/API            1978-08-11 00:00:00 112/69  \n4 016    African-American 1998-10-28 00:00:00 114/76  \n5 017    Caucasian        2001-01-09 00:00:00 124/80  \n6 018    Caucasian        1994-03-07 00:00:00 120/68  \n```\n:::\n:::\n\n### Confirm\n\n::: columns\n::: {.column width=\"35%\"}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-7_3fa22d26b761567ae301e7df954ac17e'}\n\n```{.r .cell-code}\n#\ndf_raw |>\n  janitor::clean_names() |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 31\nColumns: 38\n$ pat_id                           <chr> \"001\", \"002\", \"003\", \"004\", \"005\", \"0…\n$ treatment                        <chr> \"upa\", \"uste\", \"oza\", \"upa\", \"oza\", \"…\n$ start_date                       <dttm> 2021-01-12, 2021-01-19, 2021-02-03, …\n$ ethnic                           <chr> \"hispanic\", \"not hispanic\", \"not hisp…\n$ race                             <chr> \"Caucasian\", \"Caucasian\", \"African-Am…\n$ dob                              <dttm> 2005-01-07, 1937-04-13, 1946-06-06, …\n$ x7                               <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ start_bp                         <chr> \"114/72\", \"132/86\", \"124/92\", \"144/83…\n$ pre_post_wt_kg                   <chr> \"84/82\", \"77/77\", \"74/75\", \"66/65\", \"…\n$ start_mes                        <dbl> 3, 2, 1, 3, 3, 2, 3, 3, 2, 3, 3, 3, 3…\n$ start_bss                        <dbl> 78.06060, 54.27825, 26.51270, 79.4443…\n$ start_abd_score                  <dbl> 78.29165, 51.96852, 28.50220, 75.1931…\n$ start_sys                        <dbl> 80.31764, 53.25294, 28.56385, 78.1731…\n$ start_coping                     <dbl> 50.15692, 35.56621, 21.98904, 50.2882…\n$ start_emo                        <dbl> 71.23417, 47.81382, 35.35624, 70.2985…\n$ daily_life_impact_score_at_start <dbl> 85.93033, 59.09747, 30.75234, 87.4279…\n$ start_wbc                        <dbl> 8.2, 10.1, 5.5, 4.7, 8.9, 9.3, 5.6, 9…\n$ start_plt                        <chr> \"273\", \"414\", \"323\", \"389\", \"411\", \"4…\n$ start_na                         <dbl> 137, 142, 140, 139, 144, 145, 142, 13…\n$ start_k                          <chr> \"3.7\", \"4.0999999999999996\", \"4.3\", \"…\n$ end_month                        <dbl> 6, 6, 7, 7, 7, 8, 8, 8, 8, 8, 9, 9, 9…\n$ end_day                          <dbl> 14, 21, 6, 22, 30, 4, 10, 15, 22, 26,…\n$ end_year                         <dbl> 2021, 2021, 2021, 2021, 2021, 2021, 2…\n$ end_mes                          <dbl> 0, 1, 1, 1, 2, 1, 2, 2, 0, 1, 0, 1, 1…\n$ end_bss                          <dbl> 12.060596, 32.278245, 26.512702, 35.4…\n$ end_abd                          <dbl> 18.29165, 31.96852, 28.50220, 35.1931…\n$ end_sys                          <dbl> 8.317638, 29.252937, 28.563849, 30.17…\n$ end_coping                       <dbl> 23.156925, 26.566214, 21.989042, 32.2…\n$ end_emo                          <chr> \"30.275122309944972\", \"37.11825953633…\n$ end_dl                           <chr> \"6.4360061166151254\", \"33.73708089887…\n$ end_wbc                          <dbl> 9.211441, 10.415671, 3.000000, 4.9051…\n$ end_plt                          <dbl> 228.61315, 346.13164, 305.44946, 341.…\n$ end_na                           <dbl> 137.4247, 142.4211, 140.1604, 139.473…\n$ end_k                            <dbl> 3.897774, 4.265951, 4.317939, 3.76078…\n$ fake_street                      <chr> \"990 Mohammad Mountain\", \"8512 O'Conn…\n$ fake_city                        <chr> \"North Sigmundville\", \"Port Halstad\",…\n$ fake_state                       <chr> \"New Mexico\", \"Missouri\", \"South Caro…\n$ fake_zip                         <dbl> 96074, 11264, 57246, 31457, 30711, 52…\n```\n:::\n:::\n:::\n\n::: {.column width=\"65%\"}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-8_67bbac9dc7f8b22616048e83d3fd26f0'}\n\n```{.r .cell-code}\ndf_raw |> \n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 37\n$ pat_id                           <chr> \"001\", \"002\", \"003\", \"004\", \"005\", \"0…\n$ treatment                        <chr> \"upa\", \"uste\", \"oza\", \"upa\", \"oza\", \"…\n$ start_date                       <dttm> 2021-01-12, 2021-01-19, 2021-02-03, …\n$ ethnic                           <chr> \"hispanic\", \"not hispanic\", \"not hisp…\n$ race                             <chr> \"Caucasian\", \"Caucasian\", \"African-Am…\n$ dob                              <dttm> 2005-01-07, 1937-04-13, 1946-06-06, …\n$ start_bp                         <chr> \"114/72\", \"132/86\", \"124/92\", \"144/83…\n$ pre_post_wt_kg                   <chr> \"84/82\", \"77/77\", \"74/75\", \"66/65\", \"…\n$ start_mes                        <dbl> 3, 2, 1, 3, 3, 2, 3, 3, 2, 3, 3, 3, 3…\n$ start_bss                        <dbl> 78.06060, 54.27825, 26.51270, 79.4443…\n$ start_abd_score                  <dbl> 78.29165, 51.96852, 28.50220, 75.1931…\n$ start_sys                        <dbl> 80.31764, 53.25294, 28.56385, 78.1731…\n$ start_coping                     <dbl> 50.15692, 35.56621, 21.98904, 50.2882…\n$ start_emo                        <dbl> 71.23417, 47.81382, 35.35624, 70.2985…\n$ daily_life_impact_score_at_start <dbl> 85.93033, 59.09747, 30.75234, 87.4279…\n$ start_wbc                        <dbl> 8.2, 10.1, 5.5, 4.7, 8.9, 9.3, 5.6, 9…\n$ start_plt                        <chr> \"273\", \"414\", \"323\", \"389\", \"411\", \"4…\n$ start_na                         <dbl> 137, 142, 140, 139, 144, 145, 142, 13…\n$ start_k                          <chr> \"3.7\", \"4.0999999999999996\", \"4.3\", \"…\n$ end_month                        <dbl> 6, 6, 7, 7, 7, 8, 8, 8, 8, 8, 9, 9, 9…\n$ end_day                          <dbl> 14, 21, 6, 22, 30, 4, 10, 15, 22, 26,…\n$ end_year                         <dbl> 2021, 2021, 2021, 2021, 2021, 2021, 2…\n$ end_mes                          <dbl> 0, 1, 1, 1, 2, 1, 2, 2, 0, 1, 0, 1, 1…\n$ end_bss                          <dbl> 12.060596, 32.278245, 26.512702, 35.4…\n$ end_abd                          <dbl> 18.29165, 31.96852, 28.50220, 35.1931…\n$ end_sys                          <dbl> 8.317638, 29.252937, 28.563849, 30.17…\n$ end_coping                       <dbl> 23.156925, 26.566214, 21.989042, 32.2…\n$ end_emo                          <chr> \"30.275122309944972\", \"37.11825953633…\n$ end_dl                           <chr> \"6.4360061166151254\", \"33.73708089887…\n$ end_wbc                          <dbl> 9.211441, 10.415671, 3.000000, 4.9051…\n$ end_plt                          <dbl> 228.61315, 346.13164, 305.44946, 341.…\n$ end_na                           <dbl> 137.4247, 142.4211, 140.1604, 139.473…\n$ end_k                            <dbl> 3.897774, 4.265951, 4.317939, 3.76078…\n$ fake_street                      <chr> \"990 Mohammad Mountain\", \"8512 O'Conn…\n$ fake_city                        <chr> \"North Sigmundville\", \"Port Halstad\",…\n$ fake_state                       <chr> \"New Mexico\", \"Missouri\", \"South Caro…\n$ fake_zip                         <dbl> 96074, 11264, 57246, 31457, 30711, 52…\n```\n:::\n:::\n:::\n\n:::\n\n:::\n\n\n## Recoding\n\n::: panel-tabset\n\n### Problem\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-9_e5ad79b60d43e562724cb2ac38cc24d8'}\n\n```{.r .cell-code}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\"))\n\ndf_clean |> \n  count(ethnic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  ethnic           n\n  <chr>        <int>\n1 Hispanic         1\n2 NOT hispanic     1\n3 hispamnic        1\n4 hispanic         3\n5 not hispanic    24\n```\n:::\n:::\n\n\n### Solution\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-10_f74a579c12e2fb265e6c5748f82e3544'}\n\n```{.r .cell-code  code-line-numbers=\"4-9\"}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    )\n  )\n\ndf_clean |> \n  count(ethnic_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  ethnic_clean     n\n  <chr>        <int>\n1 hispanic         5\n2 not hispanic    25\n```\n:::\n:::\n\n\n### Confirm\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-11_e02736055b5804c79e7337654a89d998'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(ethnic_clean, ethnic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  ethnic_clean ethnic           n\n  <chr>        <chr>        <int>\n1 hispanic     Hispanic         1\n2 hispanic     hispamnic        1\n3 hispanic     hispanic         3\n4 not hispanic NOT hispanic     1\n5 not hispanic not hispanic    24\n```\n:::\n:::\n\n:::\n\n## Replace values with missing\n\n\n\n::: panel-tabset\n\n### Problem\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-12_753c87ded3559dbb8b59ef8ad57ba460'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(end_na) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 30 × 2\n   end_na     n\n    <dbl> <int>\n 1   -99      1\n 2   133.     1\n 3   135.     1\n 4   135.     1\n 5   136.     1\n 6   136.     1\n 7   137.     1\n 8   137.     1\n 9   138.     1\n10   138.     1\n# ℹ 20 more rows\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-13_dadd6d4a90536ac9572339b0a1618965'}\n\n```{.r .cell-code}\ndf_clean |> \n  ggplot(aes(x = end_na)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n:::\n\n:::\n\n### Solution\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-14_0e65c233a13f7039616660e6cfcc0924'}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    ),\n    end_na_clean = na_if(end_na, -99)\n  ) \n```\n:::\n\n\n### Confirm\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-15_ef2fd497823e25f0bafcd46b41f21117'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(end_na, end_na_clean) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 30 × 3\n   end_na end_na_clean     n\n    <dbl>        <dbl> <int>\n 1   -99           NA      1\n 2   133.         133.     1\n 3   135.         135.     1\n 4   135.         135.     1\n 5   136.         136.     1\n 6   136.         136.     1\n 7   137.         137.     1\n 8   137.         137.     1\n 9   138.         138.     1\n10   138.         138.     1\n# ℹ 20 more rows\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-16_2b4cb4a2f3bd339714b768ca47fb97b3'}\n\n```{.r .cell-code}\ndf_clean |> \n  ggplot(aes(x = end_na_clean)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n:::\n\n:::\n\n:::\n\n\n## Incorrect variable type\n\n\n::: panel-tabset\n\n### Problem\n\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-17_5d9f1bd7056f98a4792fa00def934b63'}\n\n```{.r .cell-code}\ndf_raw |> \n  select(end_emo) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 31\nColumns: 1\n$ end_emo <chr> \"30.275122309944972\", \"37.118259536333433\", \"37.07574416254249…\n```\n:::\n:::\n\n<br>\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-18_103039e7300dad783d1486a72e127c27'}\n\n```{.r .cell-code}\nmean(df_raw[[\"end_emo\"]], na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in mean.default(df_raw[[\"end_emo\"]], na.rm = TRUE): argument is not\nnumeric or logical: returning NA\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] NA\n```\n:::\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\" .fragment}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-19_a7a742d308b38f624ebee573df23d2c4'}\n\n```{.r .cell-code}\ndf_raw[[\"end_emo\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"30.275122309944972\" \"37.118259536333433\" \"37.075744162542499\"\n [4] \"44.923425798503175\" \"63.228299525683681\" \"41.86435199805284\" \n [7] \"67.32031128387257\"  \"59.876061196366294\" \"23.18900885212669\" \n[10] \"41.504922743680069\" \"30.592724281914979\" \"46.630283339296213\"\n[13] \"50.615682540772333\" \"65.526626277741144\" \"not done\"          \n[16] NA                   \"41.49300761007953\"  \"37.159835881588052\"\n[19] \"65.952234027837804\" \"14.484200057523021\" \"57.241869748195107\"\n[22] \"42.544433076049309\" \"38.365858773417663\" \"69.372774009714519\"\n[25] \"48.314764900684409\" \"48.030380025050185\" \"39.109462231952456\"\n[28] \"38.28942618055703\"  \"65.298322247205732\" \"28.551119718792652\"\n[31] \"36.381974110703389\"\n```\n:::\n:::\n\n:::\n\n:::\n\n\n### Solution\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-20_3d3a3529fedc928d4287f52a75f90c14'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    ),\n    end_na_clean = na_if(end_na, -99),\n    end_emo_clean = na_if(end_emo, \"not done\") |> as.numeric()\n  ) \n```\n:::\n\n### Confirm\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-21_27ab05f0e4f201b90ec82d0048154724'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(end_emo_clean) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 1\n$ end_emo_clean <dbl> 30.27512, 37.11826, 37.07574, 44.92343, 63.22830, 41.864…\n```\n:::\n:::\n\n<br>\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-22_9aaab483ac1a8716c0fcc071f02a7812'}\n\n```{.r .cell-code}\nmean(df_clean[[\"end_emo_clean\"]], na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 45.18381\n```\n:::\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\" .fragment}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-23_bccdb35cd45cf65dc2c72393f0477a07'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(end_emo_clean, end_emo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 30 × 3\n   end_emo_clean end_emo                n\n           <dbl> <chr>              <int>\n 1          14.5 14.484200057523021     1\n 2          23.2 23.18900885212669      1\n 3          28.6 28.551119718792652     1\n 4          30.3 30.275122309944972     1\n 5          30.6 30.592724281914979     1\n 6          36.4 36.381974110703389     1\n 7          37.1 37.075744162542499     1\n 8          37.1 37.118259536333433     1\n 9          37.2 37.159835881588052     1\n10          38.3 38.28942618055703      1\n# ℹ 20 more rows\n```\n:::\n:::\n\n:::\n\n:::\n\n:::\n\n## Character variable should be a factor\n\n\n::: panel-tabset\n\n### Problem\n\n\n::: columns\n\n::: {.column width=\"35%\"}\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-24_8a1047f3fd039e4e4d67721424c6733f'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(treatment)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  treatment     n\n  <chr>     <int>\n1 oza          10\n2 upa          10\n3 uste         10\n```\n:::\n:::\n\n<br>\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-25_8930bcacf38180b116715044d518f5a8'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(ethnic_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  ethnic_clean     n\n  <chr>        <int>\n1 hispanic         5\n2 not hispanic    25\n```\n:::\n:::\n:::\n\n\n:::\n\n\n\n::: {.column width=\"65%\" .fragment}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-26_d26bfc9474b53876b41fecd0e2aa93ca'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(treatment, ethnic_clean) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 2\n$ treatment    <chr> \"upa\", \"uste\", \"oza\", \"upa\", \"oza\", \"uste\", \"uste\", \"oza\"…\n$ ethnic_clean <chr> \"hispanic\", \"not hispanic\", \"not hispanic\", \"not hispanic…\n```\n:::\n:::\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-27_3c818d86605d5280721a4feb56bef80f'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(treatment, ethnic_clean) |> \n  tbl_summary(by = treatment)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"lzkrkkmleo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lzkrkkmleo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lzkrkkmleo thead, #lzkrkkmleo tbody, #lzkrkkmleo tfoot, #lzkrkkmleo tr, #lzkrkkmleo td, #lzkrkkmleo th {\n  border-style: none;\n}\n\n#lzkrkkmleo p {\n  margin: 0;\n  padding: 0;\n}\n\n#lzkrkkmleo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lzkrkkmleo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lzkrkkmleo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lzkrkkmleo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lzkrkkmleo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lzkrkkmleo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lzkrkkmleo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lzkrkkmleo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lzkrkkmleo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lzkrkkmleo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lzkrkkmleo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lzkrkkmleo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lzkrkkmleo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lzkrkkmleo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lzkrkkmleo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzkrkkmleo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lzkrkkmleo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lzkrkkmleo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lzkrkkmleo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzkrkkmleo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lzkrkkmleo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzkrkkmleo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lzkrkkmleo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzkrkkmleo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lzkrkkmleo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lzkrkkmleo .gt_left {\n  text-align: left;\n}\n\n#lzkrkkmleo .gt_center {\n  text-align: center;\n}\n\n#lzkrkkmleo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lzkrkkmleo .gt_font_normal {\n  font-weight: normal;\n}\n\n#lzkrkkmleo .gt_font_bold {\n  font-weight: bold;\n}\n\n#lzkrkkmleo .gt_font_italic {\n  font-style: italic;\n}\n\n#lzkrkkmleo .gt_super {\n  font-size: 65%;\n}\n\n#lzkrkkmleo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lzkrkkmleo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lzkrkkmleo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lzkrkkmleo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lzkrkkmleo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lzkrkkmleo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lzkrkkmleo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;oza&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>oza</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;upa&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>upa</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;uste&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>uste</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">ethnic_clean</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    hispanic</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">4 (40%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">1 (10%)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">0 (0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    not hispanic</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">6 (60%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">9 (90%)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">10 (100%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n:::\n\n:::\n\n:::\n\n\n### Solution\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-28_863578dac38da53aa1853d4fd9503609'}\n\n```{.r .cell-code  code-line-numbers=\"8,11\"}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    ) |> fct_infreq(),\n    end_na_clean = na_if(end_na, -99),\n    end_emo_clean = na_if(end_emo, \"not done\") |> as.numeric(),\n    treatment = fct_relevel(treatment, \"upa\", \"uste\", \"oza\")\n  ) \n```\n:::\n\n<br>\n\nSee the [forcats package](https://forcats.tidyverse.org/) for other factor handling solutions.\n\n### Confirm\n\n::: columns\n\n::: {.column width=\"35%\"}\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-29_6db6c383f57ffe3a921d92a77a1b62af'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(treatment)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  treatment     n\n  <fct>     <int>\n1 upa          10\n2 uste         10\n3 oza          10\n```\n:::\n:::\n\n<br>\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-30_438d8a3209e3c50d87c730ef5a483133'}\n\n```{.r .cell-code}\ndf_clean |> \n  count(ethnic_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  ethnic_clean     n\n  <fct>        <int>\n1 not hispanic    25\n2 hispanic         5\n```\n:::\n:::\n:::\n\n\n:::\n\n\n\n::: {.column width=\"65%\" .fragment}\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-31_7c0465eb638e47a952e988b0ee0461ea'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(treatment, ethnic_clean) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 2\n$ treatment    <fct> upa, uste, oza, upa, oza, uste, uste, oza, upa, oza, upa,…\n$ ethnic_clean <fct> hispanic, not hispanic, not hispanic, not hispanic, not h…\n```\n:::\n:::\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-32_95fef5cd745df614565cacdc9fe2a69f'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(treatment, ethnic_clean) |> \n  tbl_summary(by = treatment)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwyccbcouu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwyccbcouu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwyccbcouu thead, #xwyccbcouu tbody, #xwyccbcouu tfoot, #xwyccbcouu tr, #xwyccbcouu td, #xwyccbcouu th {\n  border-style: none;\n}\n\n#xwyccbcouu p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwyccbcouu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwyccbcouu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwyccbcouu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwyccbcouu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwyccbcouu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwyccbcouu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwyccbcouu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwyccbcouu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwyccbcouu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwyccbcouu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwyccbcouu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwyccbcouu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwyccbcouu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwyccbcouu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwyccbcouu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwyccbcouu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwyccbcouu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwyccbcouu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwyccbcouu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwyccbcouu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwyccbcouu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwyccbcouu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwyccbcouu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwyccbcouu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwyccbcouu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwyccbcouu .gt_left {\n  text-align: left;\n}\n\n#xwyccbcouu .gt_center {\n  text-align: center;\n}\n\n#xwyccbcouu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwyccbcouu .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwyccbcouu .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwyccbcouu .gt_font_italic {\n  font-style: italic;\n}\n\n#xwyccbcouu .gt_super {\n  font-size: 65%;\n}\n\n#xwyccbcouu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwyccbcouu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwyccbcouu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwyccbcouu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwyccbcouu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwyccbcouu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwyccbcouu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;upa&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>upa</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;uste&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>uste</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;oza&lt;/strong&gt;, N = 10&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>oza</strong>, N = 10<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">ethnic_clean</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"></td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    not hispanic</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">9 (90%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">10 (100%)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">6 (60%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    hispanic</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">1 (10%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">0 (0%)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">4 (40%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n:::\n\n:::\n\n:::\n\n:::\n\n\n\n## Separating values\n\n\n::: panel-tabset\n\n### Problem\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-33_66ef930402e02d28b2eb1b56125c564b'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(start_bp) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 1\n$ start_bp <chr> \"114/72\", \"132/86\", \"124/92\", \"144/83\", \"122/78\", \"121/80\", \"…\n```\n:::\n:::\n\n<br>\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-34_61fceaa17175cb6f084d03df8324e08e'}\n\n```{.r .cell-code}\nmean(df_clean[[\"start_bp\"]], na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] NA\n```\n:::\n:::\n:::\n<br>\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-35_7b191bec88c284ed6fef46c025211c95'}\n\n```{.r .cell-code}\ndf_clean[[\"start_bp\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"114/72\" \"132/86\" \"124/92\" \"144/83\" \"122/78\" \"121/80\" \"133/74\" \"116/73\"\n [9] \"118/66\" \"122/78\" \"126/82\" \"114/68\" \"118/73\" \"106/59\" \"112/69\" \"114/76\"\n[17] \"124/80\" \"120/68\" \"119/77\" \"116/74\" \"121/80\" \"112/58\" \"117/67\" \"118/73\"\n[25] \"116/74\" \"126/84\" \"144/96\" \"120/84\" \"115/75\" \"142/92\"\n```\n:::\n:::\n:::\n\n### Solution\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-36_0995371b4916a7cc2f553463f0bf0e34'}\n\n```{.r .cell-code  code-line-numbers=\"13,14\"}\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    ) |> fct_infreq(),\n    end_na_clean = na_if(end_na, -99),\n    end_emo_clean = na_if(end_emo, \"not done\") |> as.numeric(),\n    treatment = fct_relevel(treatment, \"upa\", \"uste\", \"oza\")\n    ) |>  \n  separate(start_bp, into = c(\"bp_systolic\", \"bp_diastolic\"), sep =\"/\", remove = FALSE) |> \n  mutate(across(c(bp_systolic, bp_diastolic), as.numeric)) \n```\n:::\n\n### Confirm\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-37_399100c2b9f6650149a19841ee0bdf4f'}\n\n```{.r .cell-code}\ndf_clean |> \n  select(start_bp, bp_systolic, bp_diastolic) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30\nColumns: 3\n$ start_bp     <chr> \"114/72\", \"132/86\", \"124/92\", \"144/83\", \"122/78\", \"121/80…\n$ bp_systolic  <dbl> 114, 132, 124, 144, 122, 121, 133, 116, 118, 122, 126, 11…\n$ bp_diastolic <dbl> 72, 86, 92, 83, 78, 80, 74, 73, 66, 78, 82, 68, 73, 59, 6…\n```\n:::\n:::\n\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-38_039fe724810b1e3dd8786fb88c0748b6'}\n\n```{.r .cell-code}\nmean(df_clean[[\"bp_systolic\"]], na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 121.5333\n```\n:::\n\n```{.r .cell-code}\nmean(df_clean[[\"bp_diastolic\"]], na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 76.36667\n```\n:::\n:::\n:::\n\n::: {.fragment}\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-39_8e0f9d52ca9a3259b0593ad3cd852085'}\n\n```{.r .cell-code}\ndf_clean[[\"bp_systolic\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 114 132 124 144 122 121 133 116 118 122 126 114 118 106 112 114 124 120 119\n[20] 116 121 112 117 118 116 126 144 120 115 142\n```\n:::\n\n```{.r .cell-code}\ndf_clean[[\"bp_diastolic\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 72 86 92 83 78 80 74 73 66 78 82 68 73 59 69 76 80 68 77 74 80 58 67 73 74\n[26] 84 96 84 75 92\n```\n:::\n:::\n:::\n\n:::\n\n\n## Assigning labels\n\n\n::: panel-tabset\n\n### Problem\n\nWhat does anything mean?\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-40_876b13ba3d30f78351bf7c87abb73f2e'}\n\n```{.r .cell-code}\nview(df_clean)\n```\n:::\n\ninsert screenshot\n\n### Solution 1\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-41_15e3686dbdf7992c3da0d1761ec8c2b9'}\n\n```{.r .cell-code}\n# first import codebook\ndf_codebook <- read_excel(\n  path = here(\"data\", \"messy_uc.xlsx\"),\n  sheet = \"Codebook\"\n)\ndf_codebook\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 33 × 5\n   Variable       Details                                      Units Range ...5 \n   <chr>          <chr>                                        <chr> <chr> <chr>\n 1 pat_id         Patient Identifier                           digi… 001-… <NA> \n 2 treatment      Treatment for UC                             <NA>  upad… <NA> \n 3 start_date     Date of start of treatment                   digi… YYYY… <NA> \n 4 ethnic         Ethnicity - hispanic or not hispanic         <NA>  hisp… <NA> \n 5 race           Race - one of 7 choices                      <NA>  cauc… <NA> \n 6 dob            date of birth                                digi… YYYY… <NA> \n 7 start_bp       blood pressure at start - systolic/diastolic mm Hg syst… <NA> \n 8 pre/post_wt_kg weight in kilograms at start/end             kilo… 48-1… <NA> \n 9 start_mes      Mayo endoscopic Score at start of treatment  poin… 0-3   <NA> \n10 start_bss      Bowel symptom score at start                 poin… 0-100 QOL …\n# ℹ 23 more rows\n```\n:::\n:::\n\n\n### Solution 2\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-42_b0de239e80c86984424188c0fb8ca75d'}\n\n```{.r .cell-code}\n# second create a named vector of variable names and variable labels\nvec_variables <- df_codebook |> \n  select(Variable, Details) |> \n  deframe()\n\nvec_variables\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                        pat_id \n                          \"Patient Identifier\" \n                                     treatment \n                            \"Treatment for UC\" \n                                    start_date \n                  \"Date of start of treatment\" \n                                        ethnic \n        \"Ethnicity - hispanic or not hispanic\" \n                                          race \n                     \"Race - one of 7 choices\" \n                                           dob \n                               \"date of birth\" \n                                      start_bp \n\"blood pressure at start - systolic/diastolic\" \n                                pre/post_wt_kg \n            \"weight in kilograms at start/end\" \n                                     start_mes \n \"Mayo endoscopic Score at start of treatment\" \n                                     start_bss \n                \"Bowel symptom score at start\" \n                                     start_abd \n            \"Abdominal symptom score at start\" \n                                     start_sys \n             \"Systemic symptom score at start\" \n                                  start_coping \n                       \"Coping score at start\" \n                                     start_emo \n            \"Emotional symptom score at start\" \n                                      start_dl \n       \"Impact on Daily living score at start\" \n                                     start_wbc \n    \"White blood cell count in blood at start\" \n                                     start_plt \n            \"Platelet count in blood at start\" \n                                      start_na \n              \"Sodium level in serum at start\" \n                                       start_k \n           \"Potassium level in serum at start\" \n                                     end_month \n                          \"Month of end visit\" \n                                       end_day \n                            \"Day of end visit\" \n                                      end_year \n                           \"Year of end visit\" \n                                       end_mes \n   \"Mayo endoscopic Score at end of treatment\" \n                                       end_bss \n                  \"Bowel symptom score at end\" \n                                       end_abd \n              \"Abdominal symptom score at end\" \n                                       end_sys \n               \"Systemic symptom score at end\" \n                                    end_coping \n                         \"Coping score at end\" \n                                       end_emo \n              \"Emotional symptom score at end\" \n                                        end_dl \n         \"Impact on Daily living score at end\" \n                                       end_wbc \n      \"White blood cell count in blood at end\" \n                                       end_plt \n              \"Platelet count in blood at end\" \n                                        end_na \n                \"Sodium level in serum at end\" \n                                         end_k \n             \"Potassium level in serum at end\" \n```\n:::\n:::\n\n### Solution 3\n\n\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-43_d71bfcf1ea63d282619fbf12fc5def79'}\n\n```{.r .cell-code  code-line-numbers=\"16,17|18,19,20,21,22,23,24,25\"}\n# assign labels to the data set\ndf_clean <- df_raw |>\n  janitor::clean_names() |> \n  janitor::remove_empty(which = c(\"rows\", \"cols\")) |> \n  mutate(\n    ethnic_clean = case_when(\n      ethnic %in%  c(\"hispanic\", \"Hispanic\", \"hispamnic\") ~ \"hispanic\",\n      ethnic %in%  c(\"NOT hispanic\", \"not hispanic\") ~ \"not hispanic\",\n    ) |> fct_infreq(),\n    end_na_clean = na_if(end_na, -99),\n    end_emo_clean = na_if(end_emo, \"not done\") |> as.numeric(),\n    treatment = fct_relevel(treatment, \"upa\", \"uste\", \"oza\")\n    ) |>  \n  separate(start_bp, into = c(\"bp_systolic\", \"bp_diastolic\"), sep =\"/\", remove = FALSE) |> \n  mutate(across(c(bp_systolic, bp_diastolic), as.numeric)) |> \n  # assign labels to all variables from the codebook\n  labelled::set_variable_labels(!!!vec_variables, .strict = FALSE) |> \n  # assign labels to new derived variables that did not exist in the code book\n  labelled::set_variable_labels(\n    ethnic_clean = \"Ethnicity\",\n    end_na_clean = \"Sodium level in serum at end\",\n    end_emo_clean = \"Emotional symptom score at end\",\n    bp_systolic = \"Systolic blood pressure\",\n    bp_diastolic = \"Diastolic blood pressure\"\n  )\n```\n:::\n\n### Confirm 1\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-44_4fedccebfc0e60afe01fe4321925d6cd'}\n\n```{.r .cell-code}\n# view entire data set\ndf_clean |> view()\n```\n:::\n\ninsert screenshot\n\n### Confirm 2\n\n::: {.cell hash='index_cache/revealjs/unnamed-chunk-45_9e14d7109c0062ae645bf565c4b2b782'}\n\n```{.r .cell-code}\n# view structure of data frame\ndf_clean |> str()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [30 × 42] (S3: tbl_df/tbl/data.frame)\n $ pat_id                          : chr [1:30] \"001\" \"002\" \"003\" \"004\" ...\n  ..- attr(*, \"label\")= chr \"Patient Identifier\"\n $ treatment                       : Factor w/ 3 levels \"upa\",\"uste\",\"oza\": 1 2 3 1 3 2 2 3 1 3 ...\n  ..- attr(*, \"label\")= chr \"Treatment for UC\"\n $ start_date                      : POSIXct[1:30], format: \"2021-01-12\" \"2021-01-19\" ...\n $ ethnic                          : chr [1:30] \"hispanic\" \"not hispanic\" \"not hispanic\" \"not hispanic\" ...\n  ..- attr(*, \"label\")= chr \"Ethnicity - hispanic or not hispanic\"\n $ race                            : chr [1:30] \"Caucasian\" \"Caucasian\" \"African-American\" \"Caucasian\" ...\n  ..- attr(*, \"label\")= chr \"Race - one of 7 choices\"\n $ dob                             : POSIXct[1:30], format: \"2005-01-07\" \"1937-04-13\" ...\n $ start_bp                        : chr [1:30] \"114/72\" \"132/86\" \"124/92\" \"144/83\" ...\n  ..- attr(*, \"label\")= chr \"blood pressure at start - systolic/diastolic\"\n $ bp_systolic                     : num [1:30] 114 132 124 144 122 121 133 116 118 122 ...\n  ..- attr(*, \"label\")= chr \"Systolic blood pressure\"\n $ bp_diastolic                    : num [1:30] 72 86 92 83 78 80 74 73 66 78 ...\n  ..- attr(*, \"label\")= chr \"Diastolic blood pressure\"\n $ pre_post_wt_kg                  : chr [1:30] \"84/82\" \"77/77\" \"74/75\" \"66/65\" ...\n $ start_mes                       : num [1:30] 3 2 1 3 3 2 3 3 2 3 ...\n  ..- attr(*, \"label\")= chr \"Mayo endoscopic Score at start of treatment\"\n $ start_bss                       : num [1:30] 78.1 54.3 26.5 79.4 79.6 ...\n  ..- attr(*, \"label\")= chr \"Bowel symptom score at start\"\n $ start_abd_score                 : num [1:30] 78.3 52 28.5 75.2 76.4 ...\n $ start_sys                       : num [1:30] 80.3 53.3 28.6 78.2 78.8 ...\n  ..- attr(*, \"label\")= chr \"Systemic symptom score at start\"\n $ start_coping                    : num [1:30] 50.2 35.6 22 50.3 45.7 ...\n  ..- attr(*, \"label\")= chr \"Coping score at start\"\n $ start_emo                       : num [1:30] 71.2 47.8 35.4 70.3 75.4 ...\n  ..- attr(*, \"label\")= chr \"Emotional symptom score at start\"\n $ daily_life_impact_score_at_start: num [1:30] 85.9 59.1 30.8 87.4 86.3 ...\n $ start_wbc                       : num [1:30] 8.2 10.1 5.5 4.7 8.9 9.3 5.6 9.7 8.3 7.6 ...\n  ..- attr(*, \"label\")= chr \"White blood cell count in blood at start\"\n $ start_plt                       : chr [1:30] \"273\" \"414\" \"323\" \"389\" ...\n  ..- attr(*, \"label\")= chr \"Platelet count in blood at start\"\n $ start_na                        : num [1:30] 137 142 140 139 144 145 142 138 140 137 ...\n  ..- attr(*, \"label\")= chr \"Sodium level in serum at start\"\n $ start_k                         : chr [1:30] \"3.7\" \"4.0999999999999996\" \"4.3\" \"3.5\" ...\n  ..- attr(*, \"label\")= chr \"Potassium level in serum at start\"\n $ end_month                       : num [1:30] 6 6 7 7 7 8 8 8 8 8 ...\n  ..- attr(*, \"label\")= chr \"Month of end visit\"\n $ end_day                         : num [1:30] 14 21 6 22 30 4 10 15 22 26 ...\n  ..- attr(*, \"label\")= chr \"Day of end visit\"\n $ end_year                        : num [1:30] 2021 2021 2021 2021 2021 ...\n  ..- attr(*, \"label\")= chr \"Year of end visit\"\n $ end_mes                         : num [1:30] 0 1 1 1 2 1 2 2 0 1 ...\n  ..- attr(*, \"label\")= chr \"Mayo endoscopic Score at end of treatment\"\n $ end_bss                         : num [1:30] 12.1 32.3 26.5 35.4 57.6 ...\n  ..- attr(*, \"label\")= chr \"Bowel symptom score at end\"\n $ end_abd                         : num [1:30] 18.3 32 28.5 35.2 56.4 ...\n  ..- attr(*, \"label\")= chr \"Abdominal symptom score at end\"\n $ end_sys                         : num [1:30] 8.32 29.25 28.56 30.17 54.83 ...\n  ..- attr(*, \"label\")= chr \"Systemic symptom score at end\"\n $ end_coping                      : num [1:30] 23.2 26.6 22 32.3 36.7 ...\n  ..- attr(*, \"label\")= chr \"Coping score at end\"\n $ end_emo                         : chr [1:30] \"30.275122309944972\" \"37.118259536333433\" \"37.075744162542499\" \"44.923425798503175\" ...\n  ..- attr(*, \"label\")= chr \"Emotional symptom score at end\"\n $ end_dl                          : chr [1:30] \"6.4360061166151254\" \"33.737080898872357\" \"32.25146222452932\" \"34.862045422153116\" ...\n  ..- attr(*, \"label\")= chr \"Impact on Daily living score at end\"\n $ end_wbc                         : num [1:30] 9.21 10.42 3 4.91 4.8 ...\n  ..- attr(*, \"label\")= chr \"White blood cell count in blood at end\"\n $ end_plt                         : num [1:30] 229 346 305 342 386 ...\n  ..- attr(*, \"label\")= chr \"Platelet count in blood at end\"\n $ end_na                          : num [1:30] 137 142 140 139 144 ...\n  ..- attr(*, \"label\")= chr \"Sodium level in serum at end\"\n $ end_k                           : num [1:30] 3.9 4.27 4.32 3.76 4.1 ...\n  ..- attr(*, \"label\")= chr \"Potassium level in serum at end\"\n $ fake_street                     : chr [1:30] \"990 Mohammad Mountain\" \"8512 O'Connell Valley\" \"777 Ledner Mall\" \"690 Andres Village\" ...\n $ fake_city                       : chr [1:30] \"North Sigmundville\" \"Port Halstad\" \"Croninton\" \"South Isaac\" ...\n $ fake_state                      : chr [1:30] \"New Mexico\" \"Missouri\" \"South Carolina\" \"Montana\" ...\n $ fake_zip                        : num [1:30] 96074 11264 57246 31457 30711 ...\n $ ethnic_clean                    : Factor w/ 2 levels \"not hispanic\",..: 2 1 1 1 1 1 1 2 1 2 ...\n  ..- attr(*, \"label\")= chr \"Ethnicity\"\n $ end_na_clean                    : num [1:30] 137 142 140 139 144 ...\n  ..- attr(*, \"label\")= chr \"Sodium level in serum at end\"\n $ end_emo_clean                   : num [1:30] 30.3 37.1 37.1 44.9 63.2 ...\n  ..- attr(*, \"label\")= chr \"Emotional symptom score at end\"\n```\n:::\n:::\n\n:::\n\n# Wrangling your Data\n\n## Deciding on the Unit of Observation\n\nImage\n\n## Is it the Patient?\n\n- Patient over time\n- Outcome colectomy\n- labs over time\n \n## Is it the Visit/Encounter?\n\n- Patient over time\n- Outcome colectomy\n- labs over time\n\n## Reshaping your data with tidyr\n\n## Pivoting Longer (common)\n\n- Visit Dates/Measures\n\n- Your Turn (Exercise)\n\n## Pivoting Wider\n\n# Filling in Unobserved Dates/Times with padr\n\n## Padding unobserved dates (weekends?)\n\n## Padding unovserved times\n\n## Joins of data from different sources\n\n## Local Demographics with CDC SVI data (one to one)\n\n## Patient Demographics with Lab results (one to many)\n\n\n## Thank you!\n\n🙏 [Click here to submit workshop feedback](https://forms.gle/kvEirN7sJmavem8q6){target=\"_blank\"}\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}